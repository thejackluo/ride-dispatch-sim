# Story 1.4: Complete Frontend Visualization & Controls

## Status
Draft

## Story
**As a** user,
**I want** a simple page to see the grid and control the simulation,
**so that** I can demo the system.

## Acceptance Criteria
1. The frontend polls `GET /state` and shows current data.
2. A simple grid shows drivers (green D) and riders (red R).
3. Basic buttons for "Add Driver," "Add Rider," "Request Ride," and "Next Tick."
4. Simple table showing drivers and rides.
5. Input to adjust fairness penalty.

## Tasks / Subtasks

### Simple Grid Display
- [ ] Create basic grid in `App.tsx` (AC: 2)
  - [ ] Simple HTML table or div grid (10x10 for demo)
  - [ ] Show drivers as green "D" and riders as red "R"
  - [ ] Poll `/state` every 2 seconds

### Basic Controls
- [ ] Add simple buttons to `App.tsx` (AC: 3)
  - [ ] "Add Driver" button - calls `POST /drivers` with random x,y
  - [ ] "Add Rider" button - calls `POST /riders` with random x,y  
  - [ ] "Request Ride" button - calls `POST /rides` with random pickup/dropoff
  - [ ] "Next Tick" button - calls `POST /tick`

### Simple Data Display
- [ ] Add basic tables to `App.tsx` (AC: 4)
  - [ ] Drivers table: ID, Position, Status
  - [ ] Rides table: ID, Status, Driver

### Config Input
- [ ] Add fairness penalty input (AC: 5)
  - [ ] Simple number input that calls `PUT /config`


## Dev Notes

### Simple App.tsx Structure
```tsx
function App() {
  const [state, setState] = useState(null);
  
  useEffect(() => {
    const interval = setInterval(async () => {
      const response = await fetch('http://localhost:8000/state');
      const data = await response.json();
      setState(data);
    }, 2000);
    return () => clearInterval(interval);
  }, []);

  return (
    <div>
      <h1>Ride Dispatch Simulator</h1>
      
      {/* Simple Grid */}
      <div style={{display: 'grid', gridTemplateColumns: 'repeat(10, 30px)'}}>
        {Array.from({length: 100}, (_, i) => {
          const x = i % 10;
          const y = Math.floor(i / 10);
          const driver = findDriverAt(x, y);
          const rider = findRiderAt(x, y);
          return (
            <div key={i} style={{
              width: 30, height: 30, border: '1px solid #ccc',
              backgroundColor: driver ? 'green' : rider ? 'red' : 'white',
              display: 'flex', alignItems: 'center', justifyContent: 'center'
            }}>
              {driver ? 'D' : rider ? 'R' : ''}
            </div>
          );
        })}
      </div>

      {/* Simple Controls */}
      <div>
        <button onClick={() => fetch('http://localhost:8000/drivers', {
          method: 'POST',
          body: JSON.stringify({x: Math.floor(Math.random()*10), y: Math.floor(Math.random()*10)})
        })}>Add Driver</button>
        
        <button onClick={() => fetch('http://localhost:8000/tick', {method: 'POST'})}>
          Next Tick
        </button>
      </div>

      {/* Simple Tables */}
      <table>
        <tr><th>Drivers</th></tr>
        {state?.drivers && Object.values(state.drivers).map(driver => (
          <tr key={driver.id}>
            <td>{driver.id} at ({driver.x},{driver.y}) - {driver.status}</td>
          </tr>
        ))}
      </table>
    </div>
  );
}
```

### Basic API Calls
```typescript
const addDriver = () => {
  fetch('http://localhost:8000/drivers', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
      x: Math.floor(Math.random() * 10),
      y: Math.floor(Math.random() * 10)
    })
  });
};

const nextTick = () => {
  fetch('http://localhost:8000/tick', {method: 'POST'});
};
```

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-09-18 | 1.0 | Initial story creation | Sarah (PO) |
